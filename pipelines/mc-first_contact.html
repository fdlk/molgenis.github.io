<!DOCTYPE html><!--[if lt IE 8]><html lang="en" class="ie"><![endif]--><!--[if gt IE 8]><!--><html lang="en"><!--<![endif]--><head><meta charset="utf-8"><title>MOLGENIS - Getting Started</title><meta name="description" content="What is MOLGENIS/compute and how can I use it?"><meta name="author" content="MOLGENIS community"><meta name="handheldfriendly" content="true"><meta name="mobileoptimized" content="320"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta http-equiv="cleartype" content="on"><script src="/res/js/jquery-1.11.3.min.js"> </script><script src="/res/js/bootstrap.min.js"></script><link rel="stylesheet" href="/res/css/prism.css"><link rel="stylesheet" href="/res/css/application.css" type="text/css"><link rel="shortcut icon" href="/favicon.png" type="image/png"><link rel="alternate" type="application/rss+xml" href="/blog/feed.xml" title="undefined"></head><body><header class="molgenis-docs-header"><div role="navigation" class="navbar navbar-fixed-top"><div class="header-container"><div class="navbar-header"><button type="button" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar" class="navbar-toggle collapsed"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a href="/" class="navbar-brand active"><img src="/res/images/wordmark-blue.png" alt="undefined" class="wordmark"/></a></div><div class="collapse navbar-collapse">              <ul class="nav navbar-nav"><li><a href="/software">TOOLS</a></li><li><a href="/documentation">DOCUMENTATION</a></li><li class="active"><a href="/pipelines">PIPELINES</a></li><li><a href="/develop">DEVELOP</a></li><li><a href="/support">SUPPORT</a></li><li><a href="/gcc">GCC wiki</a></li><li><a href="#searchbox" data-toggle="collapse"><i class="glyphicon glyphicon-search"></i></a></li></ul></div></div></div><div id="searchbox" class="collapse"><form role="search" action="/search-results"><input placeholder="Search" name="q" class="form-control"/></form></div><div class="molgenis-docs-titlebar active"><div class="container"> <h1>Getting Started</h1><p>What is MOLGENIS/compute and how can I use it?   </p></div></div></header><div class="molgenis-docs-body"><div class="container"><div class="row"><div role="complementary" class="col-md-3"><nav id="molgenis-docs-sidebar" class="molgenis-docs-sidebar hidden-print hidden-xs hidden-sm"><ul id="molgenis-docs-sidenav" class="nav molgenis-docs-sidenav"></ul></nav><script>$(function() {
    var sideNav = $("#molgenis-docs-sidenav");
    var index = 0;
    $(".row h1").each(function() {
        
        //create id for h1
        var id = (index++) + $(this).text().replace(/\s/gi,"-").replace(/\W/g,"").toLowerCase();
        $(this).prepend("<a name=\""+id+"\"></a>");
        
        //add h1 to list
        var li = $("<li><a href=\"#"+id+"\">"+$(this).text()+"</a></li>")
        sideNav.append(li);
        
        //wrap h1 into section
        var section = $(this).wrap("<section id=\""+id+"\"></section>").parent();
        
        //wrap parts of h1 into one section
        $(this).parent().nextUntil("h1").each(function(){            
            section.append($(this));
        });
        
        //repeat for h2
        if($("h2",$(this).parent()).length > 0) {
            var ul = $("<ul class=\"nav\"></ul>");
            li.append(ul);
            
            $("h2",$(this).parent()).each(function(){
            
                //create id for h2
                var id = (index++) + $(this).text().replace(/\s/gi,"-").replace(/\W/g,"").toLowerCase();
                $(this).prepend("<a name=\""+id+"\"></a>");
        
                //wrap h2 into section
                var section = $(this).wrap("<section id=\""+id+"\"></section>").parent();
        
                ul.append($("<li><a href=\"#"+id+"\">"+$(this).text()+"</a></li>"));
        
                //wrap parts of h2 into one section
                $(this).parent().nextUntil("h2").each(function(){            
                    section.append($(this));
                });
            

            });
        }
    });    
    
    //add "back to top"
    sideNav.append("<li><a href=\"#top\" style=\"font-size:smaller\">Back to top</a></li>");
    var $body   = $(document.body);
    
    //enable the 'active' highlighting using scrollspy plugin
    $('body').scrollspy({
        target: '#molgenis-docs-sidebar'
    });
    $('#molgenis-docs-sidebar').width($('#molgenis-docs-sidebar').parent().width());
    
    //enable affix
    $('#molgenis-docs-sidebar').affix({
        offset: {
            top: $('#molgenis-docs-sidebar').offset().top,
            bottom: $('.molgenis-docs-footer').outerHeight(true) + 10
        }
    });
    
    //resize affix box when window resizes
    $(window).resize(function () {
            $('.molgenis-docs-sidebar').width($('#molgenis-docs-sidebar').parent().width());
        });
    
    $("table").addClass("table table-bordered");
});</script></div><div role="main" class="col-md-9 contents"><h1>What is MOLGENIS Compute?</h1><p>MOLGENIS Compute is a tool to generate shell script files for big data workflows that can run in parallel on clusters and grids.</p>
<p>The code is open source and hosted on GitHub.
<a href="http://github.com/molgenis/molgenis-compute">http://github.com/molgenis/molgenis-compute</a></p>
<p>The software is licensed under the LGPL license.</p>
<h1>Download</h1><p>You can download the <a href="https://github.com/molgenis/molgenis-compute/releases">latest version of MOLGENIS Compute</a> from GitHub.</p>
<h1>Some Terms</h1><p>In MOLGENIS Compute, <strong>Data</strong> is processed using a <strong>Workflow</strong> that consists of a series of <strong>Steps</strong> that depend on each other. Each <strong>Step</strong> follows a <strong>Protocol</strong>, which is a parameterized <strong>Template</strong> for the shell script for that <strong>Step</strong>.</p>
<h1>Demo</h1><h2>Create a workflow</h2><p>We assume you have downloaded and unzipped molgenis compute commandline and are now in the directory containing the unzipped files.</p>
<p>You can generate a template for a new workflow using the command:</p>
<pre><code class="language-bash">  sh molgenis_compute.sh --create myfirst_workflow
</code></pre>
<p>This will create a new directory for the workflow:</p>
<pre><code class="language-bash">  cd myfirst_workflow
  ls
</code></pre>
<p>The directory contains a typical Molgenis Compute workflow structure</p>
<table>
<thead>
<tr>
<th>file</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>/protocols</code></td>
<td>folder with bash script Protocols</td>
</tr>
<tr>
<td><code>/protocols/step1.sh</code></td>
<td>Shell script template for the first protocol</td>
</tr>
<tr>
<td><code>/protocols/step2.sh</code></td>
<td>Shell script template for the second protocol</td>
</tr>
<tr>
<td><code>workflow.csv</code></td>
<td>file listing steps and parameter flow</td>
</tr>
<tr>
<td><code>workflow.defaults.csv</code></td>
<td>default parameters for workflow.csv (optional)</td>
</tr>
<tr>
<td><code>parameters.csv</code></td>
<td>parameters you want to run analysis on</td>
</tr>
<tr>
<td><code>header.ftl</code></td>
<td>user extra script header (optional)</td>
</tr>
<tr>
<td><code>footer.ftl</code></td>
<td>user extra script footer (optional)</td>
</tr>
</tbody>
</table>
<h2>Steps</h2><p>Take a look at the generated workflow called <code>workflow.csv</code></p>
<table>
<thead>
<tr>
<th>step</th>
<th>protocol</th>
<th>dependencies</th>
</tr>
</thead>
<tbody>
<tr>
<td>step1</td>
<td>protocols/step1.sh</td>
<td>in=input</td>
</tr>
<tr>
<td>step2</td>
<td>protocols/step2.sh</td>
<td>wf=workflowName;date=creationDate;strings=step1.out</td>
</tr>
</tbody>
</table>
<p><img src="/res/images/compute/workflow.png?raw=true," alt="image" title="the Workflow"></p>
<p>The workflow consists of two steps, <code>step1</code> and <code>step2</code>.</p>
<p><code>step1</code> has protocol <code>protocols/step1.sh</code>, <code>step2</code> has protocol <code>protocols/step2.sh</code></p>
<h2>Protocols</h2><p>Let&#39;s take a look at one of the protocol templates.
Open <code>protocols/step1.sh</code></p>
<pre><code class="language-FreeMarker">#string in
#output out

# Let&#39;s do something with string &#39;in&#39;
echo &quot;${in}_hasBeenInStep1&quot;
out=${in}_hasBeenInStep1
</code></pre>
<p>In the header of the template file, the input parameter <code>in</code> and output value <code>out</code> are declared.</p>
<p>When generating the job scripts for step 1, the value for the input parameter <code>in</code> will be inserted
into the template in those places where <code>${in}</code> is written.</p>
<h2>Parameters</h2><p>In Molgenis Compute, anything can be a parameter.</p>
<ul>
<li>the name of a working directory</li>
<li>the version number for a tool to use</li>
<li>the name of a sample to analyze</li>
<li>the amount of memory allocated for a cluster job</li>
<li>the name of a report to produce</li>
</ul>
<p>You can specify parameter values at generation time in parameter files.
In fact, for some parameters you may want to specify multiple values.</p>
<p>In this workflow, the parameter values are listed in two files:</p>
<h3>parameters.csv</h3><table>
<thead>
<tr>
<th>input</th>
</tr>
</thead>
<tbody>
<tr>
<td>hello</td>
</tr>
<tr>
<td>bye</td>
</tr>
</tbody>
</table>
<p>The <code>input</code> parameter has two different values, hello and bye.
In <code>step1</code>, the <code>input</code> parameter gets mapped to the <code>in</code> parameter of <code>protocols/step1.sh</code>.
The parameter file lists two values for this parameter so this script will be created twice, one version for <code>input=hello</code>, and one for <code>input=bye</code></p>
<h3>workflow.defaults.csv</h3><table>
<thead>
<tr>
<th>workflowName</th>
<th>creationDate</th>
</tr>
</thead>
<tbody>
<tr>
<td>myFirstWorkflow</td>
<td>today</td>
</tr>
</tbody>
</table>
<p>These parameter values will be inserted into the template for <code>step2</code>.
Let&#39;s take a look at <code>protocols/step2.sh</code></p>
<pre><code class="language-FreeMarker">#string wf
#string date
#list strings

echo &quot;Workflow name: ${wf}&quot;
echo &quot;Created: ${date}&quot;

echo &quot;Result of step1.sh:&quot;
for s in &quot;${strings[@]}&quot;
do
    echo ${s}
done


echo &quot;(FOR TESTING PURPOSES: your runid is ${runid})&quot;
</code></pre>
<p>The first three lines are the header listing the input parameters of the protocol.
In <code>step2</code> the parameter value <code>workflowName=myFirstWorkflow</code> from file <code>workflow.defaults.csv</code>
is mapped to protocol input <code>wf</code>. So when the script for <code>step2</code> gets generated, the
value <code>myFirstWorkflow</code> will be inserted where it says <code>${wf}</code>.</p>
<p>The output from <code>step1.sh</code> is parameter value <code>step1.out</code>, and <code>step2</code> maps it to parameter <code>strings</code> of this protocol.</p>
<p>But <code>step1.sh</code> will be run twice! So <code>step1.out</code> will have two different values, namely <code>hello_hasBeenInStep1</code> and <code>bye_hasBeenInStep1</code>. Of course, we could run <code>step2</code> twice, once for each value of <code>step1.out</code>. But the protocol uses <code>#list</code> to indicate that it can process multiple values for this input parameter in one single go. So a single instance of <code>step2.sh</code> will be generated. The <code>strings</code> input parameter will have a list value <code>strings=hello_hasBeenInStep1,bye_hasBeenInStep1</code>.</p>
<h2>Generate</h2><p>Let&#39;s see MOLGENIS Compute in action!</p>
<p>Go back to the molgenis compute directory and generate the scripts:</p>
<pre><code class="language-bash">sh molgenis_compute.sh --generate --parameters myfirst_workflow/parameters.csv --workflow myfirst_workflow/workflow.csv --defaults myfirst_workflow/workflow.defaults.csv
</code></pre>
<p>Take a look at the generated scripts in <code>rundir</code></p>
<table>
<thead>
<tr>
<th>file</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>step1_0.sh</code>, <code>step1_1.sh</code></td>
<td>the two scripts for <code>step1</code>, one for each value of the <code>input</code> parameter</td>
</tr>
<tr>
<td><code>step2_0.sh</code></td>
<td>the script for <code>step2</code></td>
</tr>
<tr>
<td><code>submit.sh</code></td>
<td>a submission script, which will run the generated script files in the correct order</td>
</tr>
<tr>
<td><code>user.env</code></td>
<td>the user environment, containing runtime parameter values as input the steps.</td>
</tr>
</tbody>
</table>
<h2>Run it</h2><p>We&#39;ve not specified a backend when we generated the scripts. By default the <code>submit.sh</code> will be generated for the <code>localhost</code> backend which simply calls the generated scripts in the right order.</p>
<h2>Clean up the rundir</h2><pre><code class="language-bash">sh molgenis_compute.sh --run
</code></pre>
<p>The scripts will be run, in particular you can see that the results from <code>step1</code> are correctly passed on to <code>step2</code> which <code>echo</code>s them:</p>
<pre><code>Workflow name: myFirstWorkflow
Created: today
Result of step1.sh:
hello_hasBeenInStep1
bye_hasBeenInStep1
(FOR TESTING PURPOSES: your runid is oz5N)
</code></pre><center><br><i>See something that could be better? <a href="https://github.com/molgenis/molgenis.org/tree/master/public/pipelines/mc-first_contact.md">Edit this page at Github</a></i><br></center></div></div></div></div><footer class="molgenis-docs-footer"><p>MOLGENIS and these docs are maintained by the <a href="http://www.gccgroningen.nl/about-us/people-at-the-gcc/">MOLGENIS team and collaborators</a>. <br/> Documentation source code released under the <a href="/LICENSE-MIT">MIT License</a>, documentation contents under <a href="/LICENSE-CC">CC BY 3.0</a>, and MOLGENIS software code under the <a href="/LICENSE-LGPLv3">LGPLv3 License</a>.<ul class="text-muted"><li>Version 2.0.0</li><li>·</li><li><a href="https://github.com/molgenis/molgenis">MOLGENIS Github</a></li><li>·</li><li><a href="http://github.com/molgenis/molgenis/issues">MOLGENIS Issues</a></li><li>·</li><li><a href="https://github.com/molgenis/molgenis.org/tree/master/public">Docs Github    </a></li><li>·</li><li><a href="http://github.com/molgenis/molgenis.org/issues">Docs Issues</a></li><li>·</li><li><a href="https://github.com/molgenis/molgenis/releases">Releases</a></li></ul></p></footer><script src="/res/js/prism.js"></script></body></html>