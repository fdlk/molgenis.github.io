<!DOCTYPE html><!--[if lt IE 8]><html lang="en" class="ie"><![endif]--><!--[if gt IE 8]><!--><html lang="en"><!--<![endif]--><head><meta charset="utf-8"><title>MOLGENIS - Biobank Directory</title><meta name="description" content="Use MOLGENIS to host a biobank directory"><meta name="author" content="MOLGENIS community"><meta name="handheldfriendly" content="true"><meta name="mobileoptimized" content="320"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta http-equiv="cleartype" content="on"><script src="/res/js/jquery-1.11.3.min.js"> </script><script src="/res/js/bootstrap.min.js"></script><link rel="stylesheet" href="/res/css/prism.css"><link rel="stylesheet" href="/res/css/application.css" type="text/css"><link rel="shortcut icon" href="/favicon.png" type="image/png"><link rel="alternate" type="application/rss+xml" href="/blog/feed.xml" title="undefined"></head><body><header class="molgenis-docs-header"><div role="navigation" class="navbar navbar-fixed-top"><div class="header-container"><div class="navbar-header"><button type="button" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar" class="navbar-toggle collapsed"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a href="/" class="navbar-brand active"><img src="/res/images/wordmark-blue.png" alt="undefined" class="wordmark"/></a></div><div class="collapse navbar-collapse">              <ul class="nav navbar-nav"><li><a href="/software">TOOLS</a></li><li class="active"><a href="/documentation">DOCUMENTATION</a></li><li><a href="/pipelines">PIPELINES</a></li><li><a href="/develop">DEVELOP</a></li><li><a href="/support">SUPPORT</a></li><li><a href="#searchbox" data-toggle="collapse"><i class="glyphicon glyphicon-search"></i></a></li></ul></div></div></div><div id="searchbox" class="collapse"><form role="search" action="/search-results"><input placeholder="Search" name="q" class="form-control"/></form></div><div class="molgenis-docs-titlebar active"><div class="container"> <h1>Biobank Directory</h1><p>Use MOLGENIS to host a biobank directory   </p></div></div></header><div class="molgenis-docs-body"><div class="container"><div class="row"><div role="complementary" class="col-md-3"><nav id="molgenis-docs-sidebar" class="molgenis-docs-sidebar hidden-print hidden-xs hidden-sm"><ul id="molgenis-docs-sidenav" class="nav molgenis-docs-sidenav"></ul></nav><script>$(function() {
    var sideNav = $("#molgenis-docs-sidenav");
    var index = 0;
    $(".row h1").each(function() {
        
        //create id for h1
        var id = (index++) + $(this).text().replace(/\s/gi,"-").replace(/\W/g,"").toLowerCase();
        $(this).prepend("<a name=\""+id+"\"></a>");
        
        //add h1 to list
        var li = $("<li><a href=\"#"+id+"\">"+$(this).text()+"</a></li>")
        sideNav.append(li);
        
        //wrap h1 into section
        var section = $(this).wrap("<section id=\""+id+"\"></section>").parent();
        
        //wrap parts of h1 into one section
        $(this).parent().nextUntil("h1").each(function(){            
            section.append($(this));
        });
        
        //repeat for h2
        if($("h2",$(this).parent()).length > 0) {
            var ul = $("<ul class=\"nav\"></ul>");
            li.append(ul);
            
            $("h2",$(this).parent()).each(function(){
            
                //create id for h2
                var id = (index++) + $(this).text().replace(/\s/gi,"-").replace(/\W/g,"").toLowerCase();
                $(this).prepend("<a name=\""+id+"\"></a>");
        
                //wrap h2 into section
                var section = $(this).wrap("<section id=\""+id+"\"></section>").parent();
        
                ul.append($("<li><a href=\"#"+id+"\">"+$(this).text()+"</a></li>"));
        
                //wrap parts of h2 into one section
                $(this).parent().nextUntil("h2").each(function(){            
                    section.append($(this));
                });
            

            });
        }
    });    
    
    //add "back to top"
    sideNav.append("<li><a href=\"#top\" style=\"font-size:smaller\">Back to top</a></li>");
    var $body   = $(document.body);
    
    //enable the 'active' highlighting using scrollspy plugin
    $('body').scrollspy({
        target: '#molgenis-docs-sidebar'
    });
    $('#molgenis-docs-sidebar').width($('#molgenis-docs-sidebar').parent().width());
    
    //enable affix
    $('#molgenis-docs-sidebar').affix({
        offset: {
            top: $('#molgenis-docs-sidebar').offset().top,
            bottom: $('.molgenis-docs-footer').outerHeight(true) + 10
        }
    });
    
    //resize affix box when window resizes
    $(window).resize(function () {
            $('.molgenis-docs-sidebar').width($('#molgenis-docs-sidebar').parent().width());
        });
    
    $("table").addClass("table table-bordered");
});</script></div><div role="main" class="col-md-9 contents"><h1>Biobank Directory</h1><p>The user can browse a directory of biobank collections in the Data Explorer.
Filters can be used to find relevant collections.
A particular combination of query filters can be sent to a biobank Negotiator to start a negotiation with selected biobanks.</p>
<p>If the user selects the configured collections entity and has the proper permissions, a button will be shown
labeled <code>Export to BBMRI Negotiator</code>. If the user pushes the button, MOLGENIS will create a Query on the Negotiator and
with the selected biobank collections and filters and then forward the user to the Negotiator where the user
can log in and proceed with the query.</p>
<p>The user can return to the Biobank Directory from the Negotiator to edit this selection.</p>
<h2>Permissions needed</h2><p>If you want to allow (anonymous) users to browse the biobank collections, you need to give them
the following permissions in the Permission manager:</p>
<h3>Plugin Permissions</h3><table>
<thead>
<tr>
<th>Plugin</th>
<th>Permission</th>
</tr>
</thead>
<tbody>
<tr>
<td>dataexplorer</td>
<td>View</td>
</tr>
<tr>
<td>directory</td>
<td>View</td>
</tr>
</tbody>
</table>
<h3>Entity Class Permissions</h3><table>
<thead>
<tr>
<th>Entity Class</th>
<th>Permission</th>
</tr>
</thead>
<tbody>
<tr>
<td><em>\<your collections entity></your></em></td>
<td>Read</td>
</tr>
<tr>
<td><em>\<your biobanks entity></your></em></td>
<td>Read</td>
</tr>
<tr>
<td>sys_md_Attribute</td>
<td>Read</td>
</tr>
<tr>
<td>sys_md_EntityType</td>
<td>Read</td>
</tr>
<tr>
<td>sys_md_Package</td>
<td>Read</td>
</tr>
<tr>
<td>sys_set_dataexplorer</td>
<td>Read</td>
</tr>
<tr>
<td>sys_set_directory</td>
<td>Read</td>
</tr>
</tbody>
</table>
<h2>Configuration</h2><p>An admin can configure integration with the negotiator in the <em>Directory settings</em> in the <em>Settings</em> plugin.
The collections entity that you configure should be an entity that has an <code>id</code> attribute which will
be sent as the <code>collectionID</code> for that collection and a <code>biobank</code> attribute with an <code>id</code> attribute,
which will be sent as the <code>biobankID</code> for that collection.</p>
<h1>Interaction between Directory and Negotiator</h1><h3>Create Query endpoint on Negotiator</h3><p>The Negotiator has a <code>create_query</code> endpoint.</p>
<ul>
<li>HTTP method is POST</li>
<li>Uses HTTP basic authentication with username and password</li>
<li>Content type is <code>application/json</code></li>
<li>Response contains a Location header. The Location is a URL on the Negotiator that can be opened in the browser to view
or edit the query.</li>
<li>Payload of the request is a NegotiatorQuery. This is a JSON message with the following properties:</li>
</ul>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Explanation</th>
</tr>
</thead>
<tbody>
<tr>
<td>URL*</td>
<td>String</td>
<td>A callback URL on the Directory where the user can view or update this particular selection of Collections</td>
</tr>
<tr>
<td>humanReadable*</td>
<td>String</td>
<td>Human readable form of the query used to select the collections</td>
</tr>
<tr>
<td>collections*</td>
<td>Array of Collections (<code>{collectionID, biobankID}</code>)</td>
<td>The selected collections plus their biobanks. Only the identifiers are sent, the details are available through the standard MOLGENIS REST api on the Directory</td>
</tr>
<tr>
<td>nToken</td>
<td>String</td>
<td>Used if an nToken parameter was previously appended to the callback URL on the Directory, so that the Negotiator can recognize which existing query is being updated</td>
</tr>
</tbody>
</table>
<p>Sample NegotiatorQuery:</p>
<pre><code>{
  &quot;URL&quot;           : &quot;https://molgenisâ€¦&quot;,
  &quot;humanReadable&quot; : &quot;materials is Plasma and Cryo tissue or materials is Not available
sample access fee is required&quot;,
  &quot;collections&quot;   : [{
    &quot;collectionID&quot; : &quot;bbmri-eric:collectionID:BE_B0383_LTC&quot;,
    &quot;biobankID&quot;    : &quot;bbmri-eric:biobankID:BE_B0383&quot;
  }, {
    &quot;collectionID&quot; : &quot;bbmri-eric:collectionID:BE_B03843_LTCD&quot;,
    &quot;biobankID&quot;    : &quot;bbmri-eric:biobankID:BE_B0383&quot;
  }]
}
</code></pre><p>Sequence diagram illustrating the use case where User goes to the Directory to update the biobank collection selection of an existing Negotiator query:
<img src="https://www.websequencediagrams.com/cgi-bin/cdraw?lz=VXNlciAtPiBEaXJlY3RvcnkgIDogR0VUKAAHClVSTCArIG5Ub2tlbikKCmFjdGl2YXRlACkKCgoANAotPiBOZWdvdGlhdG9yIDogUE9TAD0PLCBodW1hblJlYWRhYmxlLCBjb2xsZWN0aW9ucywAYAc9AFwSAEwKCgoAVwstAIEvDToAcQxVUkwgKDIwMikKZGUAMhUAgSsLLT4gAIIFBTogKDMwMikgUmVkAIIMBSB0bwBuDAA-CwCBcwsAgj4GAIFrDwoK&amp;s=rose" alt="image"></p>
<h2>Callback endpoint on Directory</h2><p>The callback URL to the Directory is provided in the <code>NegotiatorQuery</code>.
It can be used to edit the biobank collection selection. The Negotiator must append an <code>nToken</code> parameter to the URL.
When the user has updated the query, this <code>nToken</code> parameter will be added to the <code>NegotiatorQuery</code>.</p><center><br><i>See something that could be better? <a href="https://github.com/molgenis/molgenis.org/tree/master/public/documentation/biobank-directory.md">Edit this page at Github</a></i><br></center></div></div></div></div><footer class="molgenis-docs-footer"><p>MOLGENIS and these docs are maintained by the <a href="http://www.gccgroningen.nl/about-us/people-at-the-gcc/">MOLGENIS team and collaborators</a>. <br/> Documentation source code released under the <a href="/LICENSE-MIT">MIT License</a>, documentation contents under <a href="/LICENSE-CC">CC BY 3.0</a>, and MOLGENIS software code under the <a href="/LICENSE-LGPLv3">LGPLv3 License</a>.<ul class="text-muted"><li>Version 2.0.0</li><li>Â·</li><li><a href="https://github.com/molgenis/molgenis">MOLGENIS Github</a></li><li>Â·</li><li><a href="http://github.com/molgenis/molgenis/issues">MOLGENIS Issues</a></li><li>Â·</li><li><a href="https://github.com/molgenis/molgenis.org/tree/master/public">Docs Github    </a></li><li>Â·</li><li><a href="http://github.com/molgenis/molgenis.org/issues">Docs Issues</a></li><li>Â·</li><li><a href="https://github.com/molgenis/molgenis/releases">Releases</a></li></ul></p></footer><script src="/res/js/prism.js"></script></body></html>